<div class="nav-tabs-custom" ng-controller="controller">
    <ul class="nav nav-tabs pull-right">
        <li class="active">
            <a href="##{.Id}#-Chart" data-toggle="tab">Between X and Y</a>
        </li>
        <li class="pull-left header"><i class="fa fa-inbox"></i> #{.Name}#</li>
    </ul>
    <div class="tab-content no-padding">
        <div class="tab-pane active" id="#{.Id}#-Chart" style="position:relative;">
            <div class="panel-body" style="height: 450px;">
                <nvd3-line-chart
                        data="DHTData"
                        showXAxis="true"
                        showYAxis="true"
                        tooltips="true"
                        interactive="true">
                </nvd3-line-chart>
            </div>
        </div>
    </div>
</div>
<script src="/public/js/d3/d3.min.js"></script>
<script src="/public/js/d3/nv.d3.min.js"></script>
<script src="/public/js/d3/angularjs-nvd3-directives.min.js"></script>
<link rel="stylesheet" href="/public/js/d3//nv.d3.min.css"/>
<script>
    var thingId = "#{.Id}#";
    app.controller("controller", function($scope, $http, $interval) {
        $scope.model = {};

        /*
        TODO:
            Append Percentage to Humdity
            Append Degree to Tempearture
            Reduce Y scale to lowest - 3 and highest + 3
            Remove Y scale legend
            How can mixed types co-exist (temp vs humdity)
            Circular points
            Time scale at X
         */

        function loadFeed() {
            $http.get("/api/thing/" + thingId + "/events/200").success(function(data, status, headers, config){
                console.debug (data);
                tempData = []
                humData = []

                for (var i=0; i < data.length; i++) {
                    var state = data[i].Data;
                    tmp = state.tH + (state.tL/100)
                    tempData.push(
                        [i, tmp]
                    )

                    humData.push(
                        [i, state.h]
                    )
                }

                $scope.DHTData = [
                    { "key": "Temperature", "values": tempData },
                    { "key": "Humidity", "values": humData }
                ]
            });
        }
        loadFeed();
    });

</script>